#correlation:
reject_vars <- c('churn', 'top_iso', 'contributor', 'commentor')#

#redundant EVs:
nnn


#budgeted DFs:
34


#allocation of DFs: 

fit <- lrm(status ~ 
             rcs(size, 3) + rcs(author, 3) + rcs(top_tco, 3) + 
             jnn + jjn + integrator + 
             njj + top_rso + njn + 
             jjj + nnj + entropy + 
             jnj
           ,
           data=data1, x=T, y=T)


#AUC and the optimism:

         AUC AUC_optimism 
  0.86066222   0.01183658 

#chi-square:

                Wald Statistics          Response: status 

 Factor          Chi-Square d.f. P     
 size             70.65      2   <.0001
  Nonlinear       49.99      1   <.0001
 author           46.36      2   <.0001
  Nonlinear       10.46      1   0.0012
 top_tco          12.10      2   0.0024
  Nonlinear       11.52      1   0.0007
 jnn               5.13      1   0.0235
 jjn               0.12      1   0.7343
 integrator       17.06      1   <.0001
 njj               5.12      1   0.0237
 top_rso          11.68      1   0.0006
 njn               6.03      1   0.0141
 jjj               2.58      1   0.1085
 nnj               3.43      1   0.0642
 entropy           2.55      1   0.1104
 jnj               1.30      1   0.2548
 TOTAL NONLINEAR  82.38      3   <.0001
 TOTAL           198.23     16   <.0001

#partial effect:

             Effects              Response : status 

 Factor      Low     High       Diff.      Effect    S.E.    Lower 0.95 Upper 0.95
 size        0.00000 2357.00000 2357.00000  0.810710 0.88946 -0.9325900   2.554000
  Odds Ratio 0.00000 2357.00000 2357.00000  2.249500      NA  0.3935300  12.859000
 author      0.00000    5.00000    5.00000  3.550200 0.75746  2.0656000   5.034800
  Odds Ratio 0.00000    5.00000    5.00000 34.820000      NA  7.8901000 153.670000
 top_tco     0.00000    0.52190    0.52190  2.389300 0.87372  0.6768800   4.101800
  Odds Ratio 0.00000    0.52190    0.52190 10.906000      NA  1.9677000  60.450000
 jnn         0.00000    0.28571    0.28571 -0.579320 0.25577 -1.0806000  -0.078018
  Odds Ratio 0.00000    0.28571    0.28571  0.560280      NA  0.3393900   0.924950
 jjn         0.00000    0.10000    0.10000 -0.034802 0.10253 -0.2357700   0.166160
  Odds Ratio 0.00000    0.10000    0.10000  0.965800      NA  0.7899700   1.180800
 integrator  1.00000    2.00000    1.00000 -1.126500 0.27273 -1.6611000  -0.591960
  Odds Ratio 1.00000    2.00000    1.00000  0.324160      NA  0.1899400   0.553240
 njj         0.00000    0.33333    0.33333  1.346000 0.59504  0.1797900   2.512300
  Odds Ratio 0.00000    0.33333    0.33333  3.842200      NA  1.1970000  12.333000
 top_rso     0.34484    0.77173    0.42689 -0.898280 0.26287 -1.4135000  -0.383060
  Odds Ratio 0.34484    0.77173    0.42689  0.407270      NA  0.2432900   0.681770
 njn         0.00000    0.25000    0.25000  0.529210 0.21556  0.1067100   0.951700
  Odds Ratio 0.00000    0.25000    0.25000  1.697600      NA  1.1126000   2.590100
 jjj         0.00000    1.00000    1.00000  1.993300 1.24210 -0.4411600   4.427800
  Odds Ratio 0.00000    1.00000    1.00000  7.339900      NA  0.6432900  83.748000
 nnj         0.00000    0.33333    0.33333  1.160000 0.62666 -0.0682070   2.388200
  Odds Ratio 0.00000    0.33333    0.33333  3.190000      NA  0.9340700  10.894000
 entropy     0.43057    0.84116    0.41059  0.215120 0.13475 -0.0489870   0.479220
  Odds Ratio 0.43057    0.84116    0.41059  1.240000      NA  0.9521900   1.614800
 jnj         0.00000    1.00000    1.00000 -2.868600 2.51900 -7.8057000   2.068500
  Odds Ratio 0.00000    1.00000    1.00000  0.056778      NA  0.0004074   7.912900
